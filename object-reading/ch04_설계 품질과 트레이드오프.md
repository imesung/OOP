## 설계 품질과 트레이드오프

**객체지향 설계의 핵심은 역할, 책임, 협력이다.**

> 협력은 애플리케이션의 기능을 구현하기 위해 메시지를 주고받는 객체들 사이의 상호작용이다.
>
> 책임은 객체가 다른 객체와 협력하기 위해 수행하는 행동이다.
>
> 역할은 대체 가능한 책임의 집합이다.



**이번엔 영화 예매 시스템을 책임이 아닌 상태를 표현하는 데이터 중심의 설계를 살펴보자.**



### 데이터 중심의 영화 예매 시스템

객체지향 설계에서는 두 가지 방법으로 시스템을 객체로 분할 할 수 있는데, 첫번째는 상태를 분할의 중심축으로 두는 것이고, 두번째는 책임을 분할의 중심축으로 두는 것이다. 상태를 중심축으로 두는 것, 즉 데이터 중심의 관점은 객체의 상태에 초점을 맞추고 책임 중심의 관점은 객체의 행동에 초점을 맞추는 것이다. **전자는 개체를 독립된 데이터 덩어리로 바라보고 후자는 객체를 협력하는 공동체의 일원으로 바라본다.**

그럼 좋은 설계 방식은 무엇일까? 결론부터 말하면 객체지향 설계는 데이터가 아니라 책임에 초점을 맞춰야 한다. 그 이유는, 변경과 관련이 있다. 객체의 상태는 구현에 속하게 되고, 구현은 요구사항에 의해 매번 바뀔 수 있다. 상태를 객체 분할의 중심축으로 삼게 되면 구현에 관한 세부사항이 객체의 인터페이스에 스며들게 되면서 **캡슐화의 원칙이 무너지게 된다.** 결과적으로 상태 변경은 인터페이스의 변경을 초래하게 되고 이 인터페이스에 의존하는 모든 객체에게 변경의 영향이 퍼지게 되는 것이다.

반면에, 책임은 인터페이스에 속하게 되고, 책임을 수행하는데 필요한 상태를 캡슐화함으로써 구현 변경에 대한 외부의 파장을 막을 수 있다. 따라서 **책임에 초점을 맞추게 되면 상대적으로 변경에 안정적인 설계를 얻을 수 있게 된다.**



**영화 에매 시스템의 소스를 살펴보자**

~~~java
public class Movie {
    private String title;
    private Duration runningTime;
    private Money fee;
    private List<DiscountCondition> discountConditions;

    private MovieType movieType;	//할인 정책의 종류를 나타낸 Enum class
    private Money discountAmount;
    private double discountPercent;
}
~~~

자세히 살펴보면 할인 조건의 목록(discountConditions)이 인스턴스 변수로 Movie안에 직접 들어가 있다. 또한 DiscountPolicy라는 별도의 클래스로 분리했던 이전 예제와 달리 금액 할인 정책(discountAmount)와 비율 할인 정책(discountPercent)이 Movie 안에서 직접 정의하고 있다.