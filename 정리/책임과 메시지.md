## 책임과 메시지
- 객체지향 세계는 **명확하게 정의된 역할과 책임을 지닌 객체들이 상호 협력하는 세계이다.**
- 역할과 책임이 흐릿할수록 객체를 도와줄 어떤 협력자도 찾지 못할 것이다.
	- Ex. 많은 사람들에게 질문을 던졌을 때는 답변이 없는 경우가 많다. 하지만 한 사람을 콕 집어서 질문을 던졌을 때는 오답이든 정답이든 답변은 하게 되어있다. 	
	- 즉, **여러 사람에게 질문 했을 때는 그 사람들의 역할과 책임이 분산되어 협력하고자 하는 사람을 못찾게 되지만 한 사람을 선택하게 되면 역할과 책임이 명확해져 협력자를 쉽게 찾을 수 있는 것이다.**



### **자율적인 책임**
- 적절한 책임을 적절한 객체(자율적인 객체)에게 할당한다.
- 자율적인 객체는 스스로의 의지와 판단에 따라 각자 맡은 책임을 수행하는 객체를 의미한다.
- 즉, **적절한 책임은 자율적인 객체를 낳고, 자율적인 객체들이 모여 유연하고 단순한 협력을 낳는 것이다.**



**자신의 의지에 따라 증언할 수 있는 자유**
- 객체가 책임을 자율적으로 수행하기 위해서는 **객체에게 할당되는 책임이 자율적이어야 한다.**
	- 메시지 요청을 하고 처리 순서(객체의 행동)에 간섭하지 않는 것이 자율적인 책임을 지니는 것이다.
	- 메시지 요청 시 처리 순서를 정해주고 이 순서대로 처리 후 응답해달라고 하는 것은 자율적인 책임이 아닌 것이다.
	- 즉, **메시지를 요청할 시 기대하는 응답값이 어떻게 해서든 나오면 되기 때문에 요청 객체의 내부 행동에는 무관심하는 것이 자율적인 책임을 갖는 것이다.**



**'어떻게'가 아니라 '무엇을'**
- 자율적인 책임의 특징은 객체가 **어떻게** 해야 하는가가 아니라 **무엇을** 해야 하는가를 설명하는 것이다.





### 메시지와 메소드
- 객체들의 협력을 메시지를 주고 받으면서 진행되는데, 이 때 **메시지를 처리할 수 있다는 것은 객체가 해당 메시지에 해당하는 행동을 수행해야할 책임이 있다는 것이다.**
- 객체가 유일하게 **의사소통할 수단은 메시지** 뿐이며, 객체는 **메시지를 처리하기 위한 방법을 자율적으로 선택**할 수 있고, **외부의 객체는 메시지에 관해서만 볼 수 있고 객체 내부의 내용은 볼 수 없다.**



**메소드**
- 메시지를 처리하기 위해 내부적으로 선택하는 방법을 메소드라고 한다.
- 메시지는 '어떻게' 수행될 것인지를 명시하지 않고, 단지 '무엇'이 실행되기를 명시하며 어떤 메소드를 선택할 것인지는 전적으로 수신자의 결정에 좌우된다.



**다형성**

- **다형성은 서로 다른 유형의 객체가 동일한 메시지에 대해 서로 다르게 반응(서로 다른 메소드를 이용)하는 것이다.**
	- Ex. [앨리스 재판] '증언하라'라는 메시지에 모자장수, 요리사, 앨리스는 모두 다른 상황에 대해서 증언한다.
- 다형성은 역할, 책임, 협력에서 깊은 관련이 있는데, 서로 다른 객체들이 다형성을 만족시킨다는 것은 객체들이 **동일한 책임**을 공유한다는 것이다.
- 기본적으로 다형성은 **동일한 역할을 수행할 수 있는 객체들 사이의 대체 가능성**을 의미한다.
	- Ex. [앨리스 재판] 모자장수, 요리사, 앨리스는 각각을 대신해서 증언할 수 있다.
	- 대체 가능한 이유는 **송신자 관점에서 동일한 메시지를 수신할 수 있기 때문이다.**
- 다형성을 사용하면 송신자가 수신자의 종류를 모르더라도 메시지를 전송할 수 있다. 즉, **다형성은 수신자의 종류를 캡슐화한 것이다.**
	- 수신자의 종류를 모른다는 것은 **메시지에 대한 결합도를 낮춘 것이다.**
- **다형성을 이용하면 메시지를 이해할 수 있는 어떤 객체와도 협력할 수 있고 유연하며 확장 가능한 구조를 만들 수 있다.**

**유연하고 확장 가능하고 재사용성이 높은 협력의 의미**
- 송신자가 수신자에 대해 매우 적은 정보만 알고 있더라도 상호 협력이 가능하다는 사실은 설계의 품질에 큰 영향을 미친다.
- **첫번째, 협력이 유연해진다.**
	- 송신자는 수신자에 대해 어떤 푸쉬도 하지 않기 때문에 수신자를 다른 타입의 객체로 대체하더라도 송신자는 알지 못한다.
	- **따라서 송신자에 대한 파급효과 없이 유연하게 협력을 변경할 수 있다.**
- **두번째, 협력이 수행되는 방식을 확장할 수 있다.**
	- 송신자에게 아무런 영향을 미치지 않고 수신자를 교체할 수 있기 때문에 협력의 세부적인 수행 방식을 수정할 수 있다.
	- Ex. [앨리스 재판] '증언하라'라는 메시지를 기반으로 느슨한 관계가 이루어져 있으므로 재판장에 출석하지 않고 동영상으로 증언하거나 다른 사람과 상의를 통해 증언할 수도 있는 것이다.
- **세번째, 협력이 수행되는 방식을 재사용할 수 있다.**
	- 협력에 영향을 미치지 않고서도 다양한 객체들이 수신자의 자리를 대체할 수 있기 때문에 **다양한 문맥에서 협력을 재사용할 수 있다.**
	- Ex. 재판이라는 협력은 어느 곳에서나 재사용이 가능하다.



### 메시지를 따라라
**객체지향의 핵심, 메시지**
- 클래스를 중심에 두고 설계 하지 말아라
	- 실제로 애플리케이션을 살아있게 만드는 것은 클래스가 아니라 객체이며, 이런 **객체들의 윤곽을 결정하는 것이 바로 객체들이 주고받는 메시지이다.**
- *클래스는 단지 동적인 객체들의 특성과 행위를 정적인 텍스트로 표현하기 위해 사용할 수 있는 추상화 도구일 뿐이다.*
- 객체를 구현할 때, **협력 관계 속에서 다른 객체에게 무엇을 제공해야 하고 다른 객체로부터 무엇을 얻어야 하는가라는 관점에서 접근할 때만 훌륭한 책임을 수확할 수 있다.**



**책임-주도 설계 다시 보기**
- 책임-주도 설계의 기본 아이디어는 **객체들 간에 주고받는 메시지를 기반으로 적절한 역할과 책임, 협력을 발견하는 것이다.**
- 메시지가 수신자의 책임을 결정한다.
	- 객체는 자신에게 할당된 책임을 완수하기 위해 다른 객체의 도움이 필요하다면 또 다른 메시지를 전송할 수 있다.



**What/Who 사이클**
- What/Who 사이클은 객체 사이의 협력 관계를 설계하기 위해 **먼저 '어떤 행위(what)'를 수행할 것인지를 결정한 후 '누가(who)' 그 행위를 수행할 것인지를 결정하는 것이다.**
- **협력이라는 문맥 안에서 필요한 메시지를 먼적 결정한 후에 메시지를 수신하기에 적합한 객체를 선택한다. 그리고 수신된 메시지가 객체의 책임을 결정한다.**



**묻지말고 시켜라**
- 메시지를 먼저 결정하고 메시지에 적합한 객체를 선택하는 방식을 따르다 보면, 송신자는 수신자가 어떤 객체인지 모르기 때문에 객체에게 자세한 내용을 물어볼 수 없다. 그로인해 수신자를 믿고 메시지를 전송할 수 밖에 없다.
	- 이런 전제로 인해 묻지 말고 시켜라라는 스타일이 나타난 것이다.
- 결과적으로 **'묻지 말고 시켜라'라는 스타일은 객체를 자율적으로 만들고 캡슐화를 보장하며 결합도를 낮게 유지시켜 주기 때문에 설계를 유연하게 만든다.**





### 객체 인터페이스
**인터페이스**
- **인터페이스의 세가지 특징**
	- **첫째, 인터페이스의 사용법을 익히기만 하면 내부 구조나 동작 방식을 몰라도 쉽게 대상을 조작하거나 의사를 전달할 수 있다.**
	- **둘째, 인터페이스 자체는 변경하지 않고 단순히 내부 구성이나 작동 방식만을 변경하는 것은 인터페이스 사용자에게 어떤 영향도 미치지 않는다.**
	- **셋째, 대상이 변경되더라도 동일한 인터페이스를 제공하기만 하면 아무런 문제 없이 상호작용할 수 있다.**
- **자동차와 인터페이스**
	- 첫째, 운전자는 자동차의 내부적(엔진, 제동장치의 작동원리)인 요소를 몰라도 사용법만 익히면 조작할 수 있다.
	- 둘째, 자동차의 내부를 변경한다고 해도 운전자는 정상적으로 자동차를 운전할 수 있다.
	- 셋째, 운전자는 본인 자동차 뿐만 아니라 모든 자동차를 운전할 수 있다.



**메시지가 인터페이스를 결정한다.**
- 객체의 인터페이스는 객체가 수신할 수 있는 메시지의 목록으로 구성되어 있다.



**공용 인터페이스**
- 인터페이스는 내부에서만 접근 가능한 인터페이스와 외부에 공개되는 **공용 인터페이스**가 있다.
- 내부 인터페이스는 private method 형식을 말한다.



**책임, 메시지, 그리고 인터페이스**
- 지금까지 내용을 정리해보자
	- 협력에 참여하는 객체의 책임은 자율적이어야 한다. 즉, 객체는 자신의 의지와 판단력을 가져야 한다.
	-  한 객체가 다른 객체에게 요청을 전송할 때는 메시지를 사용한다.
	- 객체의 인터페이스는 객체가 수신할 수 있는 메시지의 목록으로 구성되어 있다.



### 인터페이스와 구현의 분리
**객체 관점에서 생각하는 방법**
- 객체지향적인 사고 방식을 이해하기 위해서는 **세가지 원칙**이 중요하다.
	- **좀 더 추상적인 인터페이스**
	- **최소 인터페이스**
	- **인터페이스와구현 간의 차이가 있다는 점을 인식**

- 좀 더 추상적인 인터페이스
	- 메시지의 처리하는 순서까지 송신하는 것이 아니라 그저 메시지만 송신하는 것이다.
	- Ex. 목격했던 장면을 떠오려라, 떠오르는 기억을 시간 순서대로 재구성해라, 말로 간결히 표현하라 -> 증언하라

- 최소 인터페이스
	- 외부에 사용할 필요가 없는 인터페이스는 최대한 노출하지 말아라.
	- 인터페이스를 최호로 유지하면 객체의 내부 동작에 대해서는 가능한 한 적은 정보만 외부에 노출할 수 있다.
	- 객체의 내부를 수정하더라도 외부에 미치는 영향을 최소화 할 수 있다.



**세번째 원칙, 구현**
- 객체를 구성하지만 공용 인터페이스에 포함되지 않는 모든 것이 구현에 포함된다. 
- 상태와 행동은 구현이다. **행동 즉, 메소드의 코드 자체는 객체 외부에 노출되는 공용 인터페이스의 일부는 아니기 때문에 객체의 구현 부분에 포함된다.**
- 객체의 외부와 내부를 분리하라는 것은 **결국 객체의 공용 인터페이스와 구현을 명확히 분리하라는 말과 동일하다.**



**캡슐화**
- **객체의 자율성을 보존하기 위해 구현을 외부로부터 감추는 것을 캡슐화라고 한다.**
- 객체는 **상태와 행위를 함께 캡슐화함으로써 충분히 협력적이고 만족스러울 정도로 자율적인 존재가 될 수 있다.** 캡슐화를 **정보은닉**이라고 부르기도 한다.



> *상태와 행위의 캡슐화*
>
> - 객체는 상태와 행동을 하나의 단위로 묶는 자율적인 실체다. 이 관점에서의 캡슐화를 **데이터 캡슐화**라고 한다.
> - 객체는 상태와 행위를 한데 묶은 후 외부에서 반드시 접근해야만 하는 행위만 골라 공용 인터페이스를 통해 노출한다. 따라서 **데이터 캡슐화는 인터페이스와 구현을 분리하기 위한 전제조건이자 자율적인 객체를 만들기 위한 전제조건이다.**



> *사적인 비밀의 캡슐화*
>
> - 외부에서 객체와 의사소통할 수 있는 고정된 경로를 공용 인터페이스라고 한다.
> - 외부에 공개해야하는 메시지만 공용 인터페이스에 포함시키고 개인적인 비밀은 공용 인터페이스 뒤에 감춤으로써, 외부의 불필요한 공격과 간섭으로부터 방어한다.
>
> - **객체를 자율적인 존재로 바라보는 것은 결국 객체의 내부와 외부를 업격하게 분리한다는 것을 의미한다.**
> - 객체지향은 **내부와 외부를 명확하게 구분하는 객체들로 구성된 협력 공동체** 이다. 이것이 **객체지향이 유연하고 재사용이 가능한 이유이다.**





### 책임의 자율성이 협력의 품질을 결정한다.
- 책임을 결정하는 것은 메시지라는 것을 기억하라.
- 책임이 얼마나 자율적인지가 전체적인 협력의 설계 품질을 결정한다. (앨리스 이야기를 곁들어 설명하겠다.)
	- **첫째, 자율적인 책임은 협력을 단순하게 만든다.**
		- **자율적인 책임은 세부적인 사항을 무시하고 의도를 드러내는 하나의 문장으로 표현함으로써 협력을 단순하게 만든다.** '목격 장면을 떠올려라', '기억을 시간 순서로 정리하라', '말로 표현하라' 대신에 '증언하라'라는 것 처럼..! 
	- **둘째, 자율적인 책임은 모자장수의 외부와 내부를 명확하게 분리한다.**
		- 모자장수의 증언 방식은 모자장수 스스로 결정할 수 있다. '증언하라'라는 메시지만 받으면 말로 하든, 적은 내용을 참고하든, 동영상을 재싱시키던 메시지를 받은 이후에는 모자장수 마음대로 응답하면 되는 것이다.
		- 이 때, 왕이 모자장수를 바라보는 관점은 **외부 관점** 이고, 모자장수가 책임을 대하는 방법은 **내부 관점**이다.
	- **셋째, 책임이 자율적일 경우 책임을 수행하는 내부적인 방법을 변경하더라도 외부에 영향을 미치지 않는다.**
		- 모자장수가 증언하는 방법을 변경하더라도 왕에게는 어떠한 영향도 미치지 않는다.
		- 만약, '목격 장면을 떠올려라', '기억을 시간 순서로 정리하라', '말로 표현하라'로 메시지를 받았을 때, 모자장수가 이 가운데 **하나라도 변경을 하게 되면 왕과 모자장수의 협력은 무너지고 만다.**
		- *객체의 책임이 자율적이면 객체 내부로 캡슐화되기 때문에 두 객체 간의 결합도도 낮아지는 것이다.*
	- **넷째, 자율적인 책임은 협력의 대상을 다양하게 선택할 수 있는 유연성을 제공한다.**
		- 왕의 입장에서 '증언하라'라는 책임을 수행할 수 있으면 모자장수가 아니더라도 다른 사람이 요청을 수신해도 문제가 되지 않는다.
		- *객체의 책임이 자율적이면 설계가 유연해지고 재사용성이 높아진다.*
	- **다섯째, 객체가 수행하는 책임들이 자율적일수록 객체의 역할을 이해하기 쉬워진다.**
		- 모자장수는 '증인석에 입장하다'와 '증언해라'라는 두 가지 책임이모여 **재판이라는 협력안에서 모자장수가 수행하는 역할(증인)이 명확하게 드러난다.**
		- 따라서, **객체의 책임이 자율적이면 객체의 존재 이유를 명확하게 표현할 수 있고, 객체는 동일한 목적을 달성하기 위한 책임들로 구성될 수 있다.**
		- *객체의 책임이 자율적이면 객체의 응집도를 높은 상태로 유지하기 쉬워진다.*



>  ***책임이 자율적일수록 적절하게 '추상화'되며, '응집도'가 높고, '결합도'가 낮아지며, '캡슐화'가 증진되고, '인터페이스와 구현이 명확히 분리'되며, 설계의 '유연성'과 '재사용성'이 향상된다.***
>
> ***객체지향의 강력함을 누리기 위한 출발점은 책임을 자율적으로 만드는 것이다.***